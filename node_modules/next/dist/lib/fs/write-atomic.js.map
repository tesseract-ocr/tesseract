{"version":3,"sources":["../../../src/lib/fs/write-atomic.ts"],"sourcesContent":["import { unlink, writeFile } from 'fs/promises'\nimport { rename } from './rename'\n\nexport async function writeFileAtomic(\n  filePath: string,\n  content: string\n): Promise<void> {\n  const tempPath = filePath + '.tmp.' + Math.random().toString(36).slice(2)\n  try {\n    await writeFile(tempPath, content, 'utf-8')\n    await rename(tempPath, filePath)\n  } catch (e) {\n    try {\n      await unlink(tempPath)\n    } catch {\n      // ignore\n    }\n    throw e\n  }\n}\n"],"names":["writeFileAtomic","filePath","content","tempPath","Math","random","toString","slice","writeFile","rename","e","unlink"],"mappings":";;;;+BAGsBA;;;eAAAA;;;0BAHY;wBACX;AAEhB,eAAeA,gBACpBC,QAAgB,EAChBC,OAAe;IAEf,MAAMC,WAAWF,WAAW,UAAUG,KAAKC,MAAM,GAAGC,QAAQ,CAAC,IAAIC,KAAK,CAAC;IACvE,IAAI;QACF,MAAMC,IAAAA,mBAAS,EAACL,UAAUD,SAAS;QACnC,MAAMO,IAAAA,cAAM,EAACN,UAAUF;IACzB,EAAE,OAAOS,GAAG;QACV,IAAI;YACF,MAAMC,IAAAA,gBAAM,EAACR;QACf,EAAE,OAAM;QACN,SAAS;QACX;QACA,MAAMO;IACR;AACF"}