{"version":3,"sources":["../../src/telemetry/post-payload.ts"],"sourcesContent":["import retry from 'next/dist/compiled/async-retry'\n\nexport function _postPayload(endpoint: string, body: object, signal?: any) {\n  if (!signal && 'timeout' in AbortSignal) {\n    signal = AbortSignal.timeout(5000)\n  }\n  return (\n    retry(\n      () =>\n        fetch(endpoint, {\n          method: 'POST',\n          body: JSON.stringify(body),\n          headers: { 'content-type': 'application/json' },\n          signal,\n        }).then((res) => {\n          if (!res.ok) {\n            const err = new Error(res.statusText)\n            ;(err as any).response = res\n            throw err\n          }\n        }),\n      { minTimeout: 500, retries: 1, factor: 1 }\n    )\n      .catch(() => {\n        // We swallow errors when telemetry cannot be sent\n      })\n      // Ensure promise is voided\n      .then(\n        () => {},\n        () => {}\n      )\n  )\n}\n"],"names":["_postPayload","endpoint","body","signal","AbortSignal","timeout","retry","fetch","method","JSON","stringify","headers","then","res","ok","err","Error","statusText","response","minTimeout","retries","factor","catch"],"mappings":";;;;+BAEgBA;;;eAAAA;;;mEAFE;;;;;;AAEX,SAASA,aAAaC,QAAgB,EAAEC,IAAY,EAAEC,MAAY;IACvE,IAAI,CAACA,UAAU,aAAaC,aAAa;QACvCD,SAASC,YAAYC,OAAO,CAAC;IAC/B;IACA,OACEC,IAAAA,mBAAK,EACH,IACEC,MAAMN,UAAU;YACdO,QAAQ;YACRN,MAAMO,KAAKC,SAAS,CAACR;YACrBS,SAAS;gBAAE,gBAAgB;YAAmB;YAC9CR;QACF,GAAGS,IAAI,CAAC,CAACC;YACP,IAAI,CAACA,IAAIC,EAAE,EAAE;gBACX,MAAMC,MAAM,IAAIC,MAAMH,IAAII,UAAU;gBAClCF,IAAYG,QAAQ,GAAGL;gBACzB,MAAME;YACR;QACF,IACF;QAAEI,YAAY;QAAKC,SAAS;QAAGC,QAAQ;IAAE,GAExCC,KAAK,CAAC;IACL,kDAAkD;IACpD,EACA,2BAA2B;KAC1BV,IAAI,CACH,KAAO,GACP,KAAO;AAGf"}